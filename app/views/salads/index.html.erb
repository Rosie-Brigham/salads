<!DOCTYPE html>
<html>
<head>
  <title>The Big Salad Share Signup</title>
  <%= csrf_meta_tags %>
  <%= stylesheet_link_tag 'application' %>
  <%= stylesheet_link_tag 'festival' %>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <div class="shooting-star"></div>
  <div class="shooting-star"></div>
  <div class="shooting-star"></div>
  <div class="container">
    <div class="festival-header">
      <h1>The Big Salad Share Signup</h1>
      <p>‚ú® Let the feat commence! ‚ú®</p>
    </div>

    <% if notice %>
      <div class="alert alert-success"><%= notice.html_safe %></div>
    <% end %>

    <% if alert %>
      <div class="alert alert-danger"><%= alert %></div>
    <% end %>

    <div class="salad-grid">
      <% @salads.each do |salad| %>
        <div class="salad-card">
          <% if salad.image_url.present? %>
            <%= image_tag salad.image_url, class: "salad-image", alt: salad.name %>
          <% end %>
          
          <div class="salad-content">
            <h2 class="salad-title"><%= salad.name %></h2>
            <p class="salad-description"><%= salad.description %></p>
            
            <div class="ingredients-list">
              <h4>ü•ó Ingredients</h4>
              <% salad.ingredients.split(',').each do |ingredient| %>
                <div class="ingredient-item"><%= ingredient.strip %></div>
              <% end %>
            </div>

            <div class="remaining-count">
              <% if salad.remaining_count > 0 %>
                <%= salad.remaining_count %> out of <%= salad.total_needed %> portions needed
              <% else %>
                All portions claimed! üéâ
              <% end %>
            </div>

            <% if salad.instructions_url.present? %>
              <div class="instructions-block">
                <div class="instructions-header">
                  <h4>üìù Recipe Instructions</h4>
                  <%= link_to "View recipe", salad.instructions_url, 
                      class: "instructions-link", 
                      target: "_blank",
                      title: "Open recipe instructions in new tab" %>
                </div>
              </div>
            <% end %>

            <% if salad.signups.any? %>
              <div class="signup-list">
                <h4>üåü Wonderful humans bringing this salad</h4>
                <% salad.signups.each do |signup| %>
                  <div class="signup-item">
                    <%= signup.name %>
                    <%= button_to 'Remove', salad_signup_path(salad, signup), 
                        method: :delete, 
                        class: 'festival-btn delete',
                        data: { turbo_confirm: 'Are you sure?' } %>
                  </div>
                <% end %>
              </div>
            <% else %>
              <div class="signup-list">
                <h4>Be the first to bring this salad! ‚ú®</h4>
              </div>
            <% end %>

            <% if salad.available? %>
              <%= form_for [salad, @signup], html: { class: 'signup-form' } do |f| %>
                <%= f.text_field :name, placeholder: "Your name", class: "form-control" %>
                <%= f.submit "Count me in! üéâ", class: "festival-btn" %>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</body>
</html>